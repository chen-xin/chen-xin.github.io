<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description"><link rel="stylesheet" type="text/css" href="/css/azw.css"></head><body><div id="header"><ul class="title-menu"><li><a class="nav" href="/">Home</a></li><li><a class="nav" href="/tags">Tags</a></li><li><a class="nav" href="/categories">Category</a></li><li><a class="nav" href="/archives">Archive</a></li><li><input id="search-site" placeholder="Search..."></li></ul><div class="post-header-wrapper"><div class="post-header"><div class="post-title">Create a Hexo theme from scratch 3-The post page</div><div class="post-meta"><div class="post-date">2018-02-20 00:18:59</div><div class="post-tag"><a class="nav tag" href="/tags/hexo/">hexo</a><a class="nav tag" href="/tags/stylus/">stylus</a><a class="nav tag" href="/tags/pug/">pug</a></div></div></div></div></div><hr><div id="content-wrapper"><div id="content"><p>The post view and the index view are rather similer. We first make copy of our <em>index.pug</em> and name it <em>post.pug</em>, then make 2 modifications:</p>
<p>First the content part, we have only one post to deal with, and all the post variables now become page variables, we shall modify our content to fit that:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#content</span><br><span class="line">  .content</span><br><span class="line">    .post</span><br><span class="line">      .post-header</span><br><span class="line">        .post-title</span><br><span class="line">          a.title(href=url_for(page.path))</span><br><span class="line">            != page.title</span><br><span class="line">        .post-meta</span><br><span class="line">          .post-meta-group</span><br><span class="line">            != full_date(page.date)</span><br><span class="line">          .post-meta-group</span><br><span class="line">            for tag in page.tags.toArray()</span><br><span class="line">              a(href=url_for(tag.path))= tag.name</span><br><span class="line">      .post-content</span><br><span class="line">        != page.content</span><br><span class="line">      .post-footer &lt;----------&gt;</span><br></pre></td></tr></table></figure></p>
<p>Second we add a <em>toc</em> widget to show post tocs:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.side-widget</span><br><span class="line">  .side-widget-toc</span><br><span class="line">    .widget-title #&#123; __(&apos;toc&apos;) &#125;</span><br><span class="line">    .widget</span><br><span class="line">      != toc(page.content, &#123;list_number: true&#125;)</span><br></pre></td></tr></table></figure></p>
<p>We love copy and paste, but once we want change someting in common, it’s not cool updating many times. Let’s put the common parts together:</p>
<p>create a <em>layout.pug</em>, put common parts in, and leave the special parts as <em>block</em>:</p>
<p>Then we shall see that the <code>.post</code> part of the index view and the post view are also similer, we can create pug mixin to deal with them:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mixin post_mixin(post)</span><br><span class="line">  .post</span><br><span class="line">    .post-header</span><br><span class="line">      .post-title</span><br><span class="line">        a.title(href=url_for(post.path))</span><br><span class="line">          != post.title</span><br><span class="line">      .post-meta</span><br><span class="line">        .post-meta-group</span><br><span class="line">          != full_date(post.date)</span><br><span class="line">        .post-meta-group</span><br><span class="line">          for tag in post.tags.toArray()</span><br><span class="line">            a(href=url_for(tag.path))= tag.name</span><br><span class="line">    .post-content</span><br><span class="line">      if post.excerpt</span><br><span class="line">        != post.excerpt</span><br><span class="line">      else</span><br><span class="line">        != post.content</span><br><span class="line">    .post-footer &lt;----------&gt;</span><br></pre></td></tr></table></figure>
<p>Now our index.pug becomes:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">extends _layout.pug</span><br><span class="line">include _post.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  for post in page.posts.toArray()</span><br><span class="line">    +post_mixin(post)</span><br></pre></td></tr></table></figure></p>
<p>And post.pug becomes:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">extends _layout.pug</span><br><span class="line">include _post.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  +post_mixin(page)</span><br><span class="line"></span><br><span class="line">block side-toc</span><br><span class="line">  .side-widget</span><br><span class="line">    .side-widget-toc</span><br><span class="line">      .widget-title #&#123; __(&apos;toc&apos;) &#125;</span><br><span class="line">      .widget</span><br><span class="line">        != toc(page.content, &#123;list_number: true&#125;)</span><br></pre></td></tr></table></figure></p>
<p>You may already noticed that the <em>toc</em> widget displaies 2 sets of number, and indent too much between levels. We shall style them like categories:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ul, ol</span><br><span class="line">  list-style-type: none</span><br><span class="line">  margin: 0</span><br><span class="line">  padding: 0</span><br><span class="line"></span><br><span class="line">ul.category-list, ul.archive, ol</span><br><span class="line">  ul, ol</span><br><span class="line">  padding-left: 1em</span><br></pre></td></tr></table></figure>
</div><div id="side-nav"><div class="side-widget"><div class="side-widget-toc"><div class="widget-title">toc</div><div class="widget"></div></div></div></div></div></body><script src="/js/az.js"></script></html>